import{r,u as W,b as X,j as t,B as k}from"./index-yY5FG0bt.js";import{Country as Y,State as Z}from"./index-fBj2P8Zh.js";import{u as ee,g as te}from"./use-fetch-Bka9Fe6A.js";import{J as se}from"./job-card-Ddo0k170.js";import{I as F}from"./input-DFCZ3pBs.js";import D from"./react-select.esm-CZHzgNmC.js";import{u as ae}from"./use-debounce-RSxlC7jG.js";import{B as L}from"./button-_2ltOKoB.js";import{u as g}from"./useSessionStorage-BK-xst6m.js";import"./card-D9zj2jZI.js";import"./createLucideIcon-Cptwm0FO.js";import"./map-pin-BAOew67m.js";import"./extends-V8a3TPL4.js";import"./floating-ui.dom-CGtuGdiq.js";const P=9,b=20,re=({jobs:s,loading:o})=>o?t.jsx(k,{className:"mb-4",width:"100%",color:"#36d7b7"}):t.jsx("div",{className:"mt-8 grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.length>0?s.map(l=>{var c;return t.jsx(se,{job:l,savedInit:((c=l==null?void 0:l.saved)==null?void 0:c.length)>0},l.id)}):t.jsx("div",{className:"col-span-3 text-center py-12",children:t.jsx("p",{className:"text-xl font-medium text-gray-600",children:"No jobs found matching your criteria"})})}),le=({currentPage:s,totalPages:o,setCurrentPage:l,loading:c})=>o>1&&t.jsxs("div",{className:"flex flex-col sm:flex-row justify-center items-center mt-8 gap-4 mb-8",children:[t.jsx(L,{onClick:()=>l(a=>Math.max(a-1,1)),disabled:s===1||c,children:"Previous"}),t.jsxs("span",{className:"text-sm sm:text-base",children:["Page ",s," of ",o]}),t.jsx(L,{onClick:()=>l(a=>Math.min(a+1,o)),disabled:s===o||c,children:"Next"})]}),ne=({country:s,setCountry:o,state:l,setState:c,company_id:a,setCompanyId:N,countryOptions:f,stateOptions:y,companyOptions:d,loadMoreOptions:C})=>{const x=r.useRef(null);return r.useEffect(()=>{const e=new IntersectionObserver(([w])=>{w.isIntersecting&&C()},{rootMargin:"100px"});return x.current&&e.observe(x.current),()=>e.disconnect()},[C]),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-6",children:[t.jsx(D,{value:f.find(e=>e.value===s)||null,onChange:e=>o((e==null?void 0:e.value)||""),options:f,placeholder:"Filter By Country",isClearable:!0,className:"w-full"}),t.jsx(D,{value:y.find(e=>e.value===l)||null,onChange:e=>c((e==null?void 0:e.value)||""),options:y,placeholder:"Filter By State",isClearable:!0,isDisabled:!s,className:"w-full"}),t.jsx(D,{value:d.find(e=>e.value===a)||null,onChange:e=>N((e==null?void 0:e.value)||""),options:d,placeholder:"Filter By Company",isClearable:!0,className:"w-full"}),t.jsx("div",{ref:x,style:{height:"1px"}})]})},ve=()=>{const[s,o]=g("jobSearchQuery",""),[l,c]=g("jobDescriptionQuery",""),[a,N]=g("selectedCountry",""),[f,y]=g("selectedState",""),[d,C]=g("selectedCompanyId",""),[x,e]=g("currentJobPage",1),[w,R]=r.useState([]),[T,E]=r.useState([]),[U,_]=r.useState([]),[v,$]=r.useState(0),[j,M]=r.useState(0),[S,q]=r.useState(0),{isLoaded:J}=W(),O=ae(l,500),{fn:z,data:p,loading:Q,totalItems:G}=ee(te,{state:f,country:a,company_id:d,searchQuery:s,descriptionQuery:O,page:x,limit:P}),{companies:u,loading:I}=X();r.useEffect(()=>{!J||I||u!=null&&u.length&&z()},[J,I,u.length,a,f,d,s,O,x]),r.useEffect(()=>{y(""),M(0),E([])},[a]),r.useEffect(()=>{e(1)},[a,f,d,s,O]);const B=r.useCallback(()=>{const m=Y.getAllCountries();if(v<m.length){const h=m.slice(v,v+b).map(({name:n,isoCode:i})=>({label:n,value:i}));R(n=>[...n,...h]),$(n=>n+b)}if(a){const h=Z.getStatesOfCountry(a);if(j<h.length){const n=h.slice(j,j+b).map(({name:i,isoCode:V})=>({label:i,value:V}));E(i=>[...i,...n]),M(i=>i+b)}}if(Array.isArray(u)&&S<u.length){const h=u.slice(S,S+b).map(({name:n,id:i})=>({label:n,value:i}));_(n=>[...n,...h]),q(n=>n+b)}},[a,j,v,S,u]);r.useEffect(()=>{B()},[B]);const A=r.useMemo(()=>Array.isArray(p)?p:(p==null?void 0:p.jobs)||[],[p]),H=G??A.length,K=Math.max(1,Math.ceil(H/P));return I||!J?t.jsx(k,{className:"mb-4",width:"100%",color:"#36d7b7"}):t.jsxs("div",{className:"container mx-auto px-4 py-8",children:[t.jsx("h1",{className:"gradient-title font-extrabold text-4xl sm:text-5xl md:text-6xl text-center pb-8",children:"Latest Jobs"}),t.jsxs("form",{className:"h-14 flex flex-col sm:flex-row w-full gap-2 items-center mb-4",onSubmit:m=>m.preventDefault(),children:[t.jsx(F,{type:"text",placeholder:"Search Jobs by Title...",className:"h-full flex-1 px-4 text-md",value:s,onChange:m=>o(m.target.value)}),t.jsx(F,{type:"text",placeholder:"Search Jobs by Description",className:"h-full flex-1 px-4 text-md",value:l,onChange:m=>c(m.target.value)})]}),t.jsx(ne,{country:a,setCountry:N,state:f,setState:y,company_id:d,setCompanyId:C,countryOptions:w,stateOptions:T,companyOptions:U,loadMoreOptions:B}),t.jsx(re,{jobs:A,loading:Q}),t.jsx(le,{currentPage:x,totalPages:K,setCurrentPage:e,loading:Q})]})};export{ve as default};
