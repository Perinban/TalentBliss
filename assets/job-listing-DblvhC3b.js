import{r as n,u as W,b as X,j as e}from"./index-CXXIjfqB.js";import{Country as Y,State as Z}from"./index-fBj2P8Zh.js";import{u as ee,g as te}from"./use-fetch-iIlkA128.js";import{J as se}from"./job-card-FhhHxnQz.js";import{I as A}from"./input-QlxYx08S.js";import I from"./react-select.esm-B1xvnabB.js";import{u as ae}from"./use-debounce-CfNPj74g.js";import{B as F}from"./button-C6bAgJ1u.js";import{u as h}from"./useSessionStorage-CewLOs00.js";import{B as P}from"./BarLoader-B1CYYx4h.js";import"./card-BOiVhx2E.js";import"./createLucideIcon-DmW9UJHA.js";import"./map-pin-CQlPT3Fk.js";import"./heart-BLFB-zwF.js";import"./extends-CEetKkoc.js";import"./floating-ui.dom-D0xtKlXs.js";const L=9,g=20,re=({jobs:s,loading:o})=>o?e.jsx(P,{className:"mb-4",width:"100%",color:"#36d7b7"}):e.jsx("div",{className:"mt-8 grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.length>0?s.map(a=>{var c;return e.jsx(se,{job:a,savedInit:((c=a==null?void 0:a.saved)==null?void 0:c.length)>0},a.id)}):e.jsx("div",{className:"col-span-3 text-center py-12",children:e.jsx("p",{className:"text-xl font-medium text-gray-600",children:"No jobs found matching your criteria"})})}),le=({currentPage:s,totalPages:o,setCurrentPage:a,loading:c})=>o>1&&e.jsxs("div",{className:"flex flex-col sm:flex-row justify-center items-center mt-8 gap-4 mb-8",children:[e.jsx(F,{onClick:()=>a(r=>Math.max(r-1,1)),disabled:s===1||c,children:"Previous"}),e.jsxs("span",{className:"text-sm sm:text-base",children:["Page ",s," of ",o]}),e.jsx(F,{onClick:()=>a(r=>Math.min(r+1,o)),disabled:s===o||c,children:"Next"})]}),ne=({country:s,setCountry:o,state:a,setState:c,company_id:r,setCompanyId:N,countryOptions:m,stateOptions:b,companyOptions:d,loadMoreOptions:y})=>{const u=n.useRef(null);return n.useEffect(()=>{const t=new IntersectionObserver(([w])=>{w.isIntersecting&&y()},{rootMargin:"100px"});return u.current&&t.observe(u.current),()=>t.disconnect()},[y]),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-6",children:[e.jsx(I,{value:m.find(t=>t.value===s)||null,onChange:t=>o((t==null?void 0:t.value)||""),options:m,placeholder:"Filter By Country",isClearable:!0,className:"w-full"}),e.jsx(I,{value:b.find(t=>t.value===a)||null,onChange:t=>c((t==null?void 0:t.value)||""),options:b,placeholder:"Filter By State",isClearable:!0,isDisabled:!s,className:"w-full"}),e.jsx(I,{value:d.find(t=>t.value===r)||null,onChange:t=>N((t==null?void 0:t.value)||""),options:d,placeholder:"Filter By Company",isClearable:!0,className:"w-full"}),e.jsx("div",{ref:u,style:{height:"1px"}})]})},Se=()=>{const[s,o]=h("jobSearchQuery",""),[a,c]=h("jobDescriptionQuery",""),[r,N]=h("selectedCountry",""),[m,b]=h("selectedState",""),[d,y]=h("selectedCompanyId",""),[u,t]=h("currentJobPage",1),[w,k]=n.useState([]),[R,B]=n.useState([]),[T,U]=n.useState([]),[C,_]=n.useState(0),[v,M]=n.useState(0),[j,$]=n.useState(0),{isLoaded:J}=W(),Q=ae(a,500),{fn:q,data:f,loading:D,totalItems:z}=ee(te,{state:m,country:r,company_id:d,searchQuery:s,descriptionQuery:Q,page:u,limit:L}),{companies:S,loading:G}=X();n.useEffect(()=>{J&&q()},[J,r,m,d,s,Q,u]),n.useEffect(()=>{b(""),M(0),B([])},[r]);const O=n.useCallback(()=>{const x=Y.getAllCountries();if(C<x.length){const p=x.slice(C,C+g).map(({name:l,isoCode:i})=>({label:l,value:i}));k(l=>[...l,...p]),_(l=>l+g)}if(r){const p=Z.getStatesOfCountry(r);if(v<p.length){const l=p.slice(v,v+g).map(({name:i,isoCode:V})=>({label:i,value:V}));B(i=>[...i,...l]),M(i=>i+g)}}if(Array.isArray(S)&&j<S.length){const p=S.slice(j,j+g).map(({name:l,id:i})=>({label:l,value:i}));U(l=>[...l,...p]),$(l=>l+g)}},[r,v,C,j,S]);n.useEffect(()=>{O()},[O]);const E=n.useMemo(()=>Array.isArray(f)?f:(f==null?void 0:f.jobs)||[],[f]),H=z??E.length,K=Math.max(1,Math.ceil(H/L));return G||!J?e.jsx(P,{className:"mb-4",width:"100%",color:"#36d7b7"}):e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"gradient-title font-extrabold text-4xl sm:text-5xl md:text-6xl text-center pb-8",children:"Latest Jobs"}),e.jsxs("form",{className:"h-14 flex flex-col sm:flex-row w-full gap-2 items-center mb-4",children:[e.jsx(A,{type:"text",placeholder:"Search Jobs by Title...",className:"h-full flex-1 px-4 text-md",value:s,onChange:x=>o(x.target.value)}),e.jsx(A,{type:"text",placeholder:"Search Jobs by Description",className:"h-full flex-1 px-4 text-md",value:a,onChange:x=>c(x.target.value)})]}),e.jsx(ne,{country:r,setCountry:N,state:m,setState:b,company_id:d,setCompanyId:y,countryOptions:w,stateOptions:R,companyOptions:T,loadMoreOptions:O}),e.jsx(re,{jobs:E,loading:D}),e.jsx(le,{currentPage:u,totalPages:K,setCurrentPage:t,loading:D})]})};export{Se as default};
