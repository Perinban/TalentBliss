const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/add-company-drawer-y1vuUTBu.js","assets/index-BjuVhAKo.js","assets/index-BjyEZQCR.css","assets/drawer-BLKmSw8f.js","assets/Combination-8WTHWc39.js","assets/button-CqojQI98.js","assets/input-C90z0wk1.js","assets/index-Dvd_FMmG.js","assets/use-fetch-C5YknjAz.js","assets/index-CnRygKRM.js","assets/extends-V8a3TPL4.js","assets/index-Ch1M4OpB.css","assets/react-select.esm-DjK8W8C_.js","assets/floating-ui.dom-CGtuGdiq.js"])))=>i.map(i=>d[i]);
import{r,j as e,u as ee,a as se,b as te,B as x,N as ae,_ as p}from"./index-BjuVhAKo.js";import{u as re,C as y,s as le,z as l}from"./index-Dvd_FMmG.js";import{u as ne,b as oe}from"./use-fetch-C5YknjAz.js";import{c as ie,B as ce}from"./button-CqojQI98.js";import{I as n}from"./input-C90z0wk1.js";import{u as T}from"./useSessionStorage-Bro7BiPs.js";const J=r.forwardRef(({className:i,...f},j)=>e.jsx("textarea",{className:ie("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",i),ref:j,...f}));J.displayName="Textarea";r.lazy(()=>p(()=>import("./add-company-drawer-y1vuUTBu.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8])));const ue=r.lazy(()=>p(()=>import("./index-CnRygKRM.js"),__vite__mapDeps([9,10,1,2,11]))),_=r.lazy(()=>p(()=>import("./react-select.esm-DjK8W8C_.js"),__vite__mapDeps([12,10,1,2,13]))),de=l.object({title:l.string().min(1,"Title is required"),description:l.string().min(1,"Description is required"),country:l.string().min(1,"Country is required"),state:l.string().min(1,"State is required"),company_id:l.string().min(1,"Select or Add a new Company"),requirements:l.string().min(1,"Requirements are required"),mode:l.string().min(1,"Mode is required"),domain:l.string().min(1,"Domain is required"),salary:l.string().min(1,"Salary is required")}),je=()=>{var O,D,R,I;const{user:i,isLoaded:f}=ee(),j=se(),{register:d,handleSubmit:L,control:h,formState:{errors:a},setValue:k,watch:o}=re({defaultValues:{state:"",country:"",company_id:"",requirements:"",mode:"",domain:"",salary:""},resolver:le(de)}),[c,A]=r.useState(null),[me,C]=r.useState(null),[F,V]=r.useState(!1),[M,z]=r.useState(!1),[B,U]=r.useState(!1),[$,G]=r.useState(!1),{companies:S,loading:H}=te(),{loading:q,data:g,fn:K}=ne(oe),[m,Q]=T("countries",[]),[b,E]=T("states",[]),W=async()=>{if(m.length>0)return;const{Country:s}=await p(async()=>{const{Country:u}=await import("./index-fBj2P8Zh.js");return{Country:u}},[]),t=s.getAllCountries().map(({name:u,isoCode:w})=>({label:u,value:w}));Q(t)},X=async s=>{const t=`states-${s}`,u=sessionStorage.getItem(t);if(u){E(JSON.parse(u));return}const{State:w}=await p(async()=>{const{State:N}=await import("./index-fBj2P8Zh.js");return{State:N}},[]),P=w.getStatesOfCountry(s).map(({name:N,isoCode:Z})=>({label:N,value:Z}));E(P),sessionStorage.setItem(t,JSON.stringify(P))},v=r.useMemo(()=>S?S.map(({name:s,id:t})=>({label:s,value:t.toString()})):[],[S]);r.useEffect(()=>{c&&(C(null),k("state",""),X(c.value))},[c]);const Y=s=>{const t={...s,recruiter_id:i.id,isOpen:!0,posted_date:new Date().toISOString()};K(t)};return r.useEffect(()=>{(g==null?void 0:g.length)>0&&j("/jobs")},[g]),f?((O=i==null?void 0:i.unsafeMetadata)==null?void 0:O.role)!=="recruiter"?e.jsx(ae,{to:"/jobs"}):e.jsxs("div",{className:"max-w-4xl mx-auto p-8 bg-white shadow-lg rounded-xl",children:[e.jsx("h1",{className:"gradient-title font-extrabold text-3xl sm:text-4xl text-center pb-8 text-gray-900",children:"Post a Job"}),e.jsxs("form",{onSubmit:L(Y),className:"space-y-6 flex flex-col max-h-[calc(100vh-200px)] overflow-auto",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(n,{className:"input-primary",placeholder:"Job Title",...d("title")}),a.title&&e.jsx("p",{className:"text-red-500 text-sm",children:a.title.message})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(J,{className:"textarea-primary",placeholder:"Job Description",...d("description")}),a.description&&e.jsx("p",{className:"text-red-500 text-sm",children:a.description.message})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"w-full sm:w-1/3",children:[F?e.jsx(r.Suspense,{fallback:e.jsx(x,{color:"#36d7b7"}),children:e.jsx(y,{name:"country",control:h,render:({field:s})=>e.jsx(_,{...s,value:m.find(t=>t.value===s.value)||null,onChange:t=>{s.onChange((t==null?void 0:t.value)||""),A(t)},options:m,placeholder:"Select Country",isClearable:!0,onFocus:()=>{m.length===0&&W()}})})}):e.jsx(n,{className:"input-primary",placeholder:"Select Country",onFocus:()=>V(!0),value:o("country")&&((D=m.find(s=>s.value===o("country")))==null?void 0:D.label)||"",readOnly:!0}),a.country&&e.jsx("p",{className:"text-red-500 text-sm",children:a.country.message})]}),e.jsxs("div",{className:"w-full sm:w-1/3",children:[M?e.jsx(r.Suspense,{fallback:e.jsx(x,{color:"#36d7b7"}),children:e.jsx(y,{name:"state",control:h,render:({field:s})=>e.jsx(_,{...s,value:b.find(t=>t.value===s.value)||null,onChange:t=>{s.onChange((t==null?void 0:t.value)||""),C(t)},options:b,placeholder:"Select State",isClearable:!0,isDisabled:!c})})}):e.jsx(n,{className:"input-primary",placeholder:"Select State",onFocus:()=>{c&&z(!0)},value:o("state")&&((R=b.find(s=>s.value===o("state")))==null?void 0:R.label)||"",readOnly:!0,disabled:!c}),a.state&&e.jsx("p",{className:"text-red-500 text-sm",children:a.state.message})]}),e.jsxs("div",{className:"w-full sm:w-1/3",children:[B?e.jsx(r.Suspense,{fallback:e.jsx(x,{color:"#36d7b7"}),children:e.jsx(y,{name:"company_id",control:h,render:({field:s})=>e.jsx(_,{...s,value:v.find(t=>t.value===s.value)||null,onChange:t=>{s.onChange((t==null?void 0:t.value)||"")},options:v,placeholder:"Select Company",isClearable:!0,isLoading:H})})}):e.jsx(n,{className:"input-primary",placeholder:"Select Company",onFocus:()=>U(!0),value:o("company_id")&&((I=v.find(s=>s.value===o("company_id")))==null?void 0:I.label)||"",readOnly:!0}),a.company_id&&e.jsx("p",{className:"text-red-500 text-sm",children:a.company_id.message})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"w-full sm:w-1/3",children:[e.jsx(n,{placeholder:"Mode (e.g., Remote)",...d("mode")}),a.mode&&e.jsx("p",{className:"text-red-500 text-sm",children:a.mode.message})]}),e.jsxs("div",{className:"w-full sm:w-1/3",children:[e.jsx(n,{placeholder:"Domain (e.g., IT)",...d("domain")}),a.domain&&e.jsx("p",{className:"text-red-500 text-sm",children:a.domain.message})]}),e.jsxs("div",{className:"w-full sm:w-1/3",children:[e.jsx(n,{placeholder:"Salary with Currency",...d("salary")}),a.salary&&e.jsx("p",{className:"text-red-500 text-sm",children:a.salary.message})]})]}),e.jsxs("div",{className:"space-y-1",children:[$?e.jsx(r.Suspense,{fallback:e.jsx(x,{color:"#36d7b7"}),children:e.jsx(y,{name:"requirements",control:h,render:({field:s})=>e.jsx(ue,{value:s.value,onChange:s.onChange})})}):e.jsx(n,{className:"input-primary",placeholder:"Requirements",onFocus:()=>G(!0),value:o("requirements"),readOnly:!0}),a.requirements&&e.jsx("p",{className:"text-red-500 text-sm",children:a.requirements.message})]}),e.jsx(ce,{type:"submit",disabled:q,children:q?"Posting...":"Post Job"})]})]}):e.jsx(x,{className:"mb-4",width:"100%",color:"#36d7b7"})};export{je as default};
